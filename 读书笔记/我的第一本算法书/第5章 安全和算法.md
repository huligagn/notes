# 安全算法

## 5-1 安全和算法

传输数据时的四个问题：

1. 窃听
2. 假冒
3. 篡改
4. 事后否认

针对以上问题，解决方法如下

| 问题     | 解决方法             |
| -------- | -------------------- |
| 窃听     | 加密                 |
| 假冒     | 消息认证码or数字签名 |
| 篡改     | 消息认证码or数字签名 |
| 事后否认 | 数字签名             |

## 5-2 加密的基础知识

数据的本质是二进制存储的，把二进制的数据通过计算，变成计算机无法理解的数据，就是加密；把密文通过计算恢复成计算机可以理解的数据，即为解密

## 5-3 哈希函数

哈希特点：

1. 哈希值的数据长度不变
2. 如果输入数据相同，哈希值也相同
3. 输入数据相似，哈希值也有很大的差异
4. 可能出现不同输入值，得到相同的哈希值，这种情况叫做哈希冲突
5. 不能从哈希值计算原值
6. 哈希计算需要快速

常用哈希算法：MD5，SHA-1和SHA-2，其中SHA-2应用较为广泛，MD5和SHA-1存在安全隐患，已经不推荐使用

## 5-4 共享密钥加密

加密和解密使用相同的密钥，称为共享密钥加密

常用算法：凯撒密码、AES、DES、动态口令，其中AES应用较为广泛

## 5-5 公开密钥加密

由数据接收者生成公开密钥和私有密钥，把公开密钥提供出去，数据发送者用公开密钥加密数据对外发送，数据接受者用私有密钥解密数据。

常用算法：RSA算法、椭圆曲线加密算法

可能存在中间人攻击：攻击者同时作为数据发送方的数据接收方、数据接收方的数据发送方

算法需要满足的条件：

- 可以使用某个数据加密，同时使用另一个数据对数据进行解密
- 无法从一个密钥推算出另一个密钥

## 5-6 混合加密

共享密钥加密存在无法按期传输密钥的问题，公开密钥加密粗才能加解密速度慢点的问题；所以可以使用混合加密：用公开密钥加密来传输共享密钥加密的密钥。

SSL/TLS协议

## 5-7 迪菲-赫尔曼密钥交换

公开密钥：$P,G$，其中P是一个非常大的素数，$G$是$P$的一个原根

消息发送方准备密钥数字：$X$，发送$G^X mod P$

消息接收方准备密钥数字：$Y$，发送$G^Y mod P$

最终消息发送方有密钥：$(G^X mod P)^Y = G^{XY} mod P$

最终消息接收方有密钥：$(G^Y mod P)^X = G^{XY}modP$

## 5-8 消息认证码

消息验证码可以实现认证和检测篡改两个功能，可以简单理解成把数据进行了一次哈希；传输时，既传输密文，又传输MAC（Message Authentication Code）。

常用算法：HMAC、OMAC、CMAC，最常用的是HMAC（Hash-based MAC）

## 5-9 数字签名

数字签名不仅可以实现认证和检测篡改，而且可以预防事后否认。

数据发送方生成公钥和私钥，然后使用私钥进行数据加密，数据接收方使用公钥进行数据解密。

因为计算复杂，一般不直接对数据进行加密解密，而是对数据的哈希值进行加密解密

## 5-10 数字认证

数据发送方把自己的公钥和个人资料发送给认证中心，认证中心确认后通过认证中心私钥生成数字签名和发送方资料作为一个文件发给数据发送方，这个文件就是数字证书；

数据发送方把证书发送给数据接收方，接收方通过认证中心的公钥，判断证书的合法性。



